.data
	# criaï¿½ï¿½o de uma matriz 22x22
	mdArray:	.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			.word 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
			
	print:		.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			.asciiz "*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*","*"
			
	# por ser uma matriz quadrada 22x22
	size: 		.word 22
	# constante que representa o tamanho do tipo do dado
	.eqv DATA_SIZE 4
	.eqv CHAR_SIZE 1
	# variavel que representa numero de bombas
	nBombas: .word 0
	# pular linha
	nline:		.asciiz "\n"
	
	# strings
	pedirLinha: .asciiz "Digite a linha: "
	pedirCol: .asciiz "Digite a coluna: "
	
.text
	.globl main
	main:
		#passo 1 colocar bombas na matriz total de 40 bombas
		# contador para 50 bombas
		li $k0, 0
		#limite de bombas
		li $k1, 200
		
		colocarBombas:
		# se contador == 50, terminar loop
		beq $k0, $k1, fimColocarBombas
		
		# Contador de rand
		move $t1, $zero
		
		
		randomNumber:
		li $v0, 30        # Syscall 30: System Time syscall
		syscall           # $a0 will contain the 32 LS bits of the system time
		move $t0, $a0     # Save $a0 value in $t0 

		li $v0, 40        # Syscall 40: Random seed
		add $a0, $zero, $zero   # Set RNG ID to 0
		add $a1, $zero, $t0     # Set Random seed to
		syscall

		li $v0, 42        # Syscall 42: Random int range
		add $a0, $zero, $zero   # Set RNG ID to 0
		li $a1, 21     # Set upper bound to 21 (exclusive)
		syscall                  # Generate a random number and put it in $a0
		add $s1, $zero, $a0     # Copy the random number to $s1
		
		# se contador = 0 ou = 1
		beq $t1, $zero, linhaB
		bne $t1, $zero, colunaB
		
		continueR:
		
		# print random number
		li $v0, 1   # 1 is the system call code to show an int number
		syscall     # as I said your generated number is at $a0, so it will be printed
		
		# Conferir contador
		bne $t1,$zero,endSwitchCaseR
		# Incrementa contador
		addi $t1,$t1,1
		
		j randomNumber
		
			
		# salvar linha e coluna	
		linhaB:
			move $t8, $s1
			j continueR
		colunaB:
			move $t9, $s1
			j continueR
		
		endSwitchCaseR:
		
		#incrementar contador
		addi $k0, $k0, 1
		#acessar posicao [$t8][$t9]
		#Row major (aqui é colocado a bomba)
		j rowMajorMatrizInteiros
		
		
		fimColocarBombas:
		
		
		
			#passo 1.2 verificar quantidade total de bombas
		#contador linha
		li $s1, 0
		#contar col
		li $s2, 1
		#size
		li $s3, 21
		# n bombas
		li $s5, 0 
		# char da bomba
		li $s6, 9
		loopContarBLinha:
			
			#incrementar linha
			addi $s1, $s1, 1
			# se linha == 21, terminar loop
			beq $s1, $s3, fimContarBombas
			
			li $s2, 1
			
			loopContarBCol:
				
				#encontrar posição e analisar se valor é igual a 9
				la $t1, mdArray
				lw $t2, size
				li $t3, 4 # data_size
			
				li $t4, 0
				mul $t4, $s1, $t2 # t4 = rowIndex * size
				add $t4, $t4, $s2 # t4 = t4 + colIndex
				mul $t4, $t4, $t3 # t4 = t4 * dataSize
				add $t1, $t1, $t4 # addr = t1 = t1 + t4
				
				#carregar valor da posicao
				lw $s4, ($t1)
				
				# se *pos == 9
				bne $s4, $s6, continueContarBombas
				addi $s5, $s5, 1 # nBombas++
				
				continueContarBombas:
				#incrementar e verificar
				addi $s2, $s2, 1 # col++
				beq $s2, $s3, loopContarBLinha # if col == 21, terminar
				j loopContarBCol
				
		fimContarBombas:
		
		#armazenar numero de bombas
		sw $s5, nBombas
		
			
		
		rodarJogo:
		
		#passo 2 imprimir matriz de caracteres
		j printMatrizChars
		
		#passo 3 solicitar linha e coluna do usuario
		solicitarLinCol:
		# armazena linha em t8 e coluna em t9
		la $a0, pedirLinha
		li $v0, 4
		syscall # imprimir 
		
		li $v0, 5
		syscall
		move $t8, $v0 # ler
		
		la $a0, pedirCol
		li $v0, 4
		syscall # imprimir 
		
		li $v0, 5
		syscall
		move $t9, $v0 # ler
			
		
		j fim
		#passo 4 verificar se tem bomba na posiÃ§Ã£o e verificar os vizinhos
		# Mudar os registradores para os de linha e coluna que o usuario quer 
		# Acessando o indici que o usuario escolheu
		
		#mult linha,coluna
		#mtlo $t2
		
		
		
		#passo 5 colocar as dicas
		
		#passo 6 verifica se o usuario ganhou
		
		#passo 7 caso o usuario nao ganhou voltar ao passo 2
		
		# addr = baseAddr + (rowIndex * size + colIndex) * dataSize
		rowMajorMatrizInteiros:
			# row index e col index deve estar sempre armazenados em t8 e t9 respectivamente
			la $t1, mdArray
			lw $t2, size
			li $t3, 4 # data_size
			
			li $t4, 0
			mul $t4, $t8, $t2 # t4 = rowIndex * size
			add $t4, $t4, $t9 # t4 = t4 + colIndex
			mul $t4, $t4, $t3 # t4 = t4 * dataSize
			add $t1, $t1, $t4 # addr = t1 = t1 + t4
			#bomba
			li $t5, 9
			sw $t5, ($t1)
			
			j colocarBombas
			
		
		
		
			printMatriz:
		# carregar endereco da matriz em t1 e em k0
		la $t1, mdArray
		la $k0, mdArray
		
		# valor limite
		li $s6, 21
		
		#contador linha
		li $s0, 1
		
		# imprimir linha por linha
		loopLinha:
			# imprimir pular linha(\n)
			li $v0, 4
			la $a0, nline
			syscall
			# se linha = 11, terminar
			beq $s0, $s6, endPrintMatriz
			#contador coluna
			li $s1, 1
			
			loopColuna:
				# carregar valor do endereco em t2
				lw $t2, 0($t1)
				
				# imprimir valor
				li $v0, 1
				move $a0, $t2
				syscall
				
				# optional - syscall number for printing character (space)
    				li      $a0, 32
    				li      $v0, 11  
    				syscall
    
				# avancar para proximo endereco
				mul $t1, $s0, 22
				add $t1, $t1, $s1
				mul $t1, $t1, DATA_SIZE
				add $t1, $t1, $k0
				
				# coluna++
				addi $s1, $s1, 1
			
				# se coluna != 11, continuar loop
				bne $s1, $s6, loopColuna
			
				# senao, linha++
				addi $s0, $s0, 1
				# recomecar
				j loopLinha
		
		endPrintMatriz:
		
		
		
		printMatrizChars:
			# carregar endereco da matriz em t1 e em k0
		la $t1, print
		la $k0, print
		
		# valor limite
		li $s6, 21
		#gambiarra
		li $s7, 41
		
		#contador linha
		li $s0, 1
		
		# imprimir linha por linha
		loopLinhaMC:
			# imprimir pular linha(\n)
			li $v0, 4
			la $a0, nline
			syscall
			# se linha = 21, terminar
			beq $s0, $s6, endPrintMatrizChars
			#contador coluna
			li $s1, 1
			
			loopColunaMC:
				# carregar valor do endereco em t2
				#lw $t2, 0($t1)
				
				# imprimir valor
				li $v0, 4
				la $a0, ($t1)
				syscall
				
				# optional - syscall number for printing character (space)
    				li      $a0, 32
    				li      $v0, 11  
    				syscall
    
				# avancar para proximo endereco
				mul $t1, $s0, 22
				add $t1, $t1, $s1
				mul $t1, $t1, CHAR_SIZE
				add $t1, $t1, $k0
				
				# coluna++
				addi $s1, $s1, 1
			
				# se coluna != 21, continuar loop
				bne $s1, $s7, loopColunaMC
			
				# senao, linha++
				addi $s0, $s0, 1
				# recomecar
				j loopLinhaMC
			endPrintMatrizChars:
			j solicitarLinCol
			
	fim:
			
